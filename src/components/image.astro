---
import { BASE_URL } from '@/shared/consts'
import { Image as AstroImage, type ImgAttributes } from 'astro:assets'

type Props = ImgAttributes & {
  alt: string
  width: number
  height: number
  lazy?: boolean
} & ({ src: string; name?: string } | { src?: string; name: string })

const {
  src,
  alt,
  name,
  width,
  height,
  decoding,
  fetchpriority,
  lazy = false,
  class: extraClass,
  ...restProps
} = Astro.props
const localResource = name ? `${BASE_URL}/${name}.webp` : `${BASE_URL}/not-found.webp`
const source = src?.startsWith('http') ? src : localResource

const loading = lazy ? 'lazy' : 'eager'
---

<AstroImage
  src={source}
  {alt}
  {width}
  {height}
  {loading}
  {decoding}
  {fetchpriority}
  class={extraClass}
  {...restProps}
/>
